{% extends "layout/basic.html" %}

{% block title %}{{ employee }}{% endblock %}

{% block content %}
<table class="table">
  <tr class="blue">
      <th class="col_detail1">ФИО</th>
      <th class="col_detail2">{{ employee }}{% if user.employees_permission_level >= EDIT or user.is_staff %}<a href="{% url 'vacations:employee_update_form' employee.pk %}"><button class="button">Редактировать</button></a><a href="{% url 'vacations:employee_delete_form' employee.pk %}"><button class="button deletebutton">Удалить сотрудника</button></a>{% endif %}</th>

  </tr>
  <tr class="white">
      <td class="col_detail1">Отдел</td>
      <td><a href="{% url 'vacations:by_department' employee.department.pk %}">{{ employee.department }}</a></td>
  </tr>
  <tr class="gray">
      <td class="col_detail1">Дата начала работы</td>
      <td>{{ employee.entry_date }}</td>
  </tr>
  <tr class="white">
      <td class="col_detail1">Рейтинг</td>
      <td>{{ employee.rating }}</td>
  </tr>
  <tr class="gray">
      <td class="col_detail1">Замещает</td>
      <td>{% if employee.replaces is null %}Нет{% else %}<a href="{% url 'vacations:details' employee.replaces.pk %}">{{ employee.replaces }}</a>{% endif %}</td>
  </tr>
  <tr class="white">
      <td class="col_detail1">Отпускные дни</td>
      <td>{{ employee.vacation_days }}</td>
  </tr>
  <tr class="gray">
      <td class="col_detail1">Отпуска</td>
      <td>{% for vacation in vacations %}
          {% if vacation.employee.pk == employee.pk %}
          {{ vacation.start|date:"SHORT_DATE_FORMAT" }} - {{ vacation.end|date:"SHORT_DATE_FORMAT" }} [{{ vacation.relevance }}]{% if user.is_department_manager or user.is_staff %}<a href="{% url 'vacations:vacation_delete_form' vacation.pk %}">X</a><br>{% endif %}
          {% endif %}
      {% endfor %}</td>
  </tr>
  {% if user.is_department_manager or user.is_staff %}
  <tr class="white">
      <td class="col_detail1">Добавить отпуск</td>
      <td><form method="post">
          {% csrf_token %}
          {# form.as_p #}
          {# for field in form #}
          <div class="fieldWrapper">
              {{ form.start.label_tag }} {{ form.start }}
          </div>
          <div class="fieldWrapper">
              {{ form.end.label_tag }} {{ form.end }}
          </div>
          {{ form.employee.as_hidden }}

          {% if form.errors %}
              {% for field in form %}
                  {% for error in field.errors %}
                      <div class="alert alert-danger">
                          <strong>Field: {{ error|escape }}</strong>
                      </div>
                  {% endfor %}
              {% endfor %}
              {% for error in form.non_field_errors %}
                  <div class="alert alert-danger" style="color: red;">
                      <strong>Non-Field: {{ error|escape }}</strong>

                  </div>
              {% endfor %}
              <input type="submit" class="button" name="force_proceed" value="Игнорировать и добавить">

          {% endif %}

          <input type="submit" class="button" value="Добавить">
      </form></td>
  </tr>
  {% endif %}
</table>
{% endblock %}